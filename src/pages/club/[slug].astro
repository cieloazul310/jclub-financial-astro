---
import { getCollection } from "astro:content";
import type { InferGetStaticPropsType } from "astro";
import { SarkaraLayout } from "@cieloazul310/astro-sarkara";
import Table from "../../components/Table/Table.astro";
import { siteMetadata, menu } from "../../data";

export async function getStaticPaths() {
  const clubs = await getCollection("club");
  const dataset = await getCollection("dataset");

  return clubs.map(({ data }) => {
    const { slug } = data;
    const reg = new RegExp(slug);
    return {
      params: {
        slug,
      },
      props: {
        ...data,
        dataset: dataset
          .filter((datum) => datum.id.match(reg))
          .map((datum) => datum.data)
          .sort((a, b) => a.year - b.year),
      },
    };
  });
}

type Props = InferGetStaticPropsType<typeof getStaticPaths>;

const { fullname, dataset } = Astro.props;
---

<SarkaraLayout title={fullname} siteMetadata={siteMetadata} menu={menu}>
  <Table slot="jumbotron" dataset={dataset} tab="pl" />
</SarkaraLayout>
